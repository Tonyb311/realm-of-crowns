import { RaceDefinition } from '../../../types/race';

export const changeling: RaceDefinition = {
  id: 'changeling',
  name: 'Changelings',
  tier: 'exotic',
  lore: "Changelings are shapeshifters who can assume the appearance of any humanoid they've seen. Their true form — pale, featureless, with blank white eyes and smooth, almost unfinished features — is rarely shown. They have no homeland because they don't need one; they live among every race, wearing faces that aren't their own. This isn't deception for its own sake (usually) — it's survival. A race of shapeshifters makes everyone paranoid, so Changelings learned long ago to hide what they are. They form loose underground networks called \"The Veil\" — spy rings, information brokers, and mutual protection societies. If you need to know something, find a Changeling. If you can.",
  trait: {
    name: 'Shapechanger',
    description: 'Supreme social manipulators with fluid identity.',
  },
  statModifiers: { str: 0, dex: 2, con: 0, int: 2, wis: 1, cha: 4 },
  abilities: [
    {
      name: 'Change Appearance',
      description: 'Shift appearance to any race/gender. Cosmetic only at first.',
      levelRequired: 1,
      type: 'active',
      effectType: 'shapeshift',
      effectValue: { cosmeticOnly: true, anyRace: true, anyGender: true },
      targetType: 'self',
    },
    {
      name: 'Unsettling Visage',
      description: 'Force attacker to reroll a hit (they see their own face)',
      levelRequired: 5,
      type: 'active',
      effectType: 'combat_reaction',
      effectValue: { forceReroll: true, usesPerCombat: 1 },
      targetType: 'enemy',
    },
    {
      name: 'Perfect Mimicry',
      description: 'Appearance shift now fools racial detection: NPCs treat you as the race you appear',
      levelRequired: 10,
      type: 'passive',
      effectType: 'shapeshift_upgrade',
      effectValue: { foolsDetection: true, npcTreatAsRace: true },
      targetType: 'self',
    },
    {
      name: 'Identity Theft',
      description: "Copy a specific player's appearance — can interact as them briefly",
      levelRequired: 15,
      type: 'active',
      effectType: 'impersonation',
      effectValue: { copySpecificPlayer: true },
      cooldownSeconds: 86400,
      targetType: 'self',
    },
    {
      name: "The Veil's Network",
      description: 'Access to Changeling spy network: can buy intelligence on any player or town',
      levelRequired: 25,
      type: 'passive',
      effectType: 'intel_network',
      effectValue: { buyIntelligence: true, scope: 'any_player_or_town' },
      targetType: 'self',
    },
    {
      name: 'Thousand Faces',
      description: 'Can shift appearance mid-combat, gain +3 AC for 1 turn after each shift',
      levelRequired: 40,
      type: 'passive',
      effectType: 'combat_shapeshift',
      effectValue: { midCombatShift: true, acBonusPerShift: 3, acDurationTurns: 1 },
      targetType: 'self',
    },
  ],
  professionBonuses: [
    { professionType: 'merchant', speedBonus: 0, qualityBonus: 0, yieldBonus: 0.30, xpBonus: 0 },
    { professionType: 'courier', speedBonus: 0.25, qualityBonus: 0, yieldBonus: 0, xpBonus: 0 },
    { professionType: 'innkeeper', speedBonus: 0, qualityBonus: 0, yieldBonus: 0.20, xpBonus: 0 },
    { professionType: 'social_professions', speedBonus: 0, qualityBonus: 0, yieldBonus: 0.15, xpBonus: 0 },
  ],
  gatheringBonuses: [
    { resourceType: 'herbs', biome: 'any', bonusPercent: 5 },
    { resourceType: 'ore', biome: 'any', bonusPercent: 5 },
    { resourceType: 'wood', biome: 'any', bonusPercent: 5 },
    { resourceType: 'fiber', biome: 'any', bonusPercent: 5 },
    { resourceType: 'hide', biome: 'any', bonusPercent: 5 },
  ],
  homelandRegion: 'Everywhere and Nowhere',
  startingTowns: [],
  specialMechanics: {
    canShapeshift: true,
    noHometown: true,
    noHometownDetails: {
      description: "Changelings don't start in a racial homeland — they start in any town they choose and receive no racial majority penalties anywhere (because they can look like they belong). The trade-off: they have no safe home base, no guaranteed allies, and if their true nature is discovered by other players, trust evaporates.",
      startAnywhere: true,
      noRacialPenalties: true,
    },
    theVeilNetwork: {
      description: 'At Level 25, Changelings access a secret information marketplace where they can buy intelligence on any player, sell information they\'ve gathered, and take espionage contracts.',
      levelRequired: 25,
      features: ['buy_player_intel', 'sell_information', 'espionage_contracts'],
    },
  },
};
